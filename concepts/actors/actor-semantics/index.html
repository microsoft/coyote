<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://microsoft.github.io/coyote/concepts/actors/actor-semantics/">
    <link rel="shortcut icon" href="/coyote/img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Actor semantics - Coyote</title>
    <link href="/coyote/css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="/coyote/css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="/coyote/css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="/coyote/css/highlight.css">
    <link href="../../../css/main.css" rel="stylesheet">
    <link href="../../../css/player-controls.css" rel="stylesheet">
    <link href="../../../css/syntax.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="/coyote/js/jquery-3.2.1.min.js"></script>
    <script src="/coyote/js/bootstrap-3.3.7.min.js"></script>
    <script src="/coyote/js/highlight.pack.js"></script>
    <script src="https://consentdeliveryfd.azurefd.net/mscc/lib/v2/wcp-consent.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '/coyote/';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Actor semantics", url: "#_top", children: [
          ]},
          {title: "Semantics of actor creation", url: "#semantics-of-actor-creation", children: [
          ]},
          {title: "Semantics of actor messages", url: "#semantics-of-actor-messages", children: [
          ]},
          {title: "Distributed systems modeling", url: "#distributed-systems-modeling", children: [
          ]},
        ];

    </script>
    <script src="/coyote/js/base.js"></script>
      <script src="../../../assets/js/analytics.js"></script>
      <script src="../../../assets/js/plugins.js"></script>
      <script src="../../../assets/js/animate_trace.js"></script>
      <script src="../../../assets/js/animation.js"></script>
      <script src="../../../assets/js/progress_bar.js"></script>
      <script src="../../../assets/js/trace_model.js"></script>
      <script src="../../../assets/js/main.js"></script>

</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>

<div id="cookie-banner"></div>


<div class="wrapper wm-page-content">
  <div class="container-fluid">
    <a name="_top"></a>
      

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../termination/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../termination/" class="btn btn-xs btn-link">
        Actor termination
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../state-machines/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../state-machines/" class="btn btn-xs btn-link">
        State machines
      </a>
    </div>
    
  </div>

      

      <h2 id="actor-semantics">Actor semantics</h2>
<p>An <code>Actor</code> in Coyote is an in-memory object. The main APIs that define the semantics of programming
with actors are <code>CreateActor</code>, which is used to create a new <code>Actor</code> instance, and <code>SendEvent</code> that
is used to pass an event to an existing <code>Actor</code>. It is useful to understand both the synchronous and
asynchronous guarantees of these methods.</p>
<h2 id="semantics-of-actor-creation">Semantics of actor creation</h2>
<p>Suppose you create an <code>Actor</code> as follows:</p>
<pre><code class="language-csharp">ActorId clientId = this.CreateActor(typeof(Client));
</code></pre>
<p>This call synchronously creates the inbox of the actor. The initialization of the new actor happens
asynchronously in the background. Think of this as follows: the call takes only as long as it takes
to create an inbox. It does not wait for the initialization code of the target actor to finish. This
is enough to guarantee that you can start sending messages to the new actor immediately after
creating it. Basically, if you have an <code>ActorId</code>, then you can send messages to it. The Coyote
runtime will initialize the new actor in the background, and ensure that its initialization finishes
before letting the actor process its inbox.</p>
<h2 id="semantics-of-actor-messages">Semantics of actor messages</h2>
<p>Actors in Coyote have both in-order as well as causal-delivery semantics. Lets break down this
guarantee into pieces. If one actor sends two messages to another actor as follows:</p>
<pre><code class="language-csharp">this.SendEvent(id, e1);
this.SendEvent(id, e2);
</code></pre>
<p>Then it is guaranteed that <code>e1</code> will be delivered to the inbox of <code>id</code> before <code>e2</code>. This is the
<em>in-order</em> part of the message-delivery semantics. To explain causal delivery, we need to consider
three actors <code>A</code>, <code>B</code> and <code>C</code>. Suppose that <code>A</code> first sends a message <code>e1</code> to <code>C</code> and then it sends
a message <code>e2</code> to <code>B</code>. Next, <code>B</code> is programmed so that whenever it receives a message <code>e2</code>, it will
forward it to <code>C</code>.</p>
<p><img alt="abc" src="../../../assets/images/abc.svg" /></p>
<p>For this program, the message <code>e1</code> is guaranteed to reach the inbox of <code>C</code> before
<code>e2</code>. There is a simple way of thinking about this guarantee. The call to <code>SendEvent</code> ensures that
the message is delivered to the inbox of the target before it returns. (It does not wait for the
message to be processed&mdash;that can happen asynchronously.) Thus, when <code>A</code> sent message <code>e1</code> to <code>C</code>,
it was delivered to the inbox of <code>C</code> even before the message <code>e2</code> was sent out. Thus, <code>e2</code> had no
chance of <em>overtaking</em> <code>e1</code> to reach the inbox of <code>C</code> first.</p>
<h2 id="distributed-systems-modeling">Distributed systems modeling</h2>
<p>Suppose that you have written a distributed system where each node of the system is running its own
set of Coyote actors and these actors communicate over the network. When you write a Coyote test for
checking end-to-end behaviors (by using a mock of the network to connect all the remote nodes
together in the same test), then be sure to consider the difference in the delivery semantics of the
network and the Coyote API <code>SendEvent</code>. Usually, real networks will provide more relaxed guarantees
than <code>SendEvent</code> for performance reasons. Closing this gap requires modeling. For instance, a
network that can either lose a message, deliver it once, or deliver it twice can be modeled as
follows:</p>
<pre><code class="language-csharp">if(this.Random())
{
   this.SendEvent(destination, message);
}
if(this.Random())
{
   this.SendEvent(destination, message);
}
</code></pre>
<p>See also <a href="../state-machines/#precise-semantics">State machine semantics</a>.</p>

    <br>
      

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../termination/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../termination/" class="btn btn-xs btn-link">
        Actor termination
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../state-machines/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../state-machines/" class="btn btn-xs btn-link">
        State machines
      </a>
    </div>
    
  </div>

      <br>
  </div>
</div>

<footer class="wm-page-content">
  

<section class="footer-join pt-40 pb-80">
  <div class="container-fluid">
    <div class="row text-center">
      <div class="col-sm-8 col-sm-offset-2">
      </div>
    </div>
    <div class="row">
   </div>
  </div>
</section>
<section class="footer-dark pt-60">
  <div class="container-fluid">
    <div class="row">
      <div class="hidden-xs col-sm-5 col-lg-6">
        <a href="" title="homepage" class="logo-footer">
          <img src="/coyote/assets/images/icon.png" alt="Coyote">
        </a>
      </div>

      <div class="col-sm-2 col-xs-4 footer-dark-col">
        <nav>
          <h4>Coyote</h4>
          <ul class="list-unstyled">
            <li><a href="/coyote/">Home</a></li>
            <li><a href="/coyote/get-started/install/">Install</a></li>
            <li><a href="https://github.com/microsoft/coyote/"><i class="fa fa-github"></i>
GitHub</a></li>
          </ul>
        </nav>
      </div>

      <div class="col-sm-2 col-xs-4 footer-dark-col">
        <nav>
          <h4>Resources</h4>
          <ul class="list-unstyled">
            <li><a href="/coyote/tutorials/first-concurrency-unit-test/">Getting started</a></li>
            <li><a href="/coyote/tutorials/overview/">Tutorials</a></li>
            <li><a href="/coyote/ref/Microsoft.Coyote">API documentation</a></li>
          </ul>
        </nav>
      </div>

      <div class="col-sm-2 col-xs-4 footer-dark-col">
        <nav>
          <h4>Community</h4>
          <ul class="list-unstyled">
            <li><a href="https://github.com/microsoft/coyote/discussions"><i class="fa fa-github"></i>
GitHub</a></li>
            <li><a href="https://twitter.com/coyote_dev" target="_blank"><i class="fa fa-twitter"></i> Twitter</a></li>
            <li><a href="https://teams.microsoft.com/l/channel/19%3a1fe966b4fdc544bca648d89bf25c3c56%40thread.tacv2/General?groupId=7a6d8afc-c23d-4e5d-b9cb-9124118c0220&tenantId=72f988bf-86f1-41af-91ab-2d7cd011db47" target="_blank">Teams (Internal)</a></li>
          </ul>
        </nav>
      </div>
    </div>

    <div class="row footnote pt-50 pb-20">
      <div class="col-sm-12">
        <hr>
      </div>
      <div class="col-sm-7">
        <ul class="list-unstyled list-inline footnote-copy">
          <li><a href="https://go.microsoft.com/fwlink/?LinkId=521839" target="_blank">Privacy & Cookies</a></li>
          <li><a href="https://go.microsoft.com/fwlink/?linkid=2259814" target="_blank">Consumer Health Privacy</a></li>
          <li><a href="https://go.microsoft.com/fwlink/?LinkID=206977" target="_blank">Terms of Use</a></li>
          <li><a href="https://www.microsoft.com/en-us/legal/intellectualproperty/trademarks" target="_blank">Trademarks</a></li>
          <li><a href="https://github.com/microsoft/coyote/blob/main/LICENSE" target="_blank">License</a></li>
        </ul>
      </div>
      <div class="col-sm-5 text-right footnote-copy">
        <ul class="list-unstyled list-inline">
          <li><span id="copyright"></span></li>
          <li><a href="https://www.microsoft.com/" target="_blank"><img class="img-responsive" src="/coyote/assets/images/microsoft-logo.svg?v=3" alt="Microsoft">&nbsp;</a></li>
        </ul>
      </div>
    </div>
  </div>
</section>
</footer>


<script type="text/javascript">
    $(document).ready(function () {
      $('table').each(function () {
        $(this).addClass("table");
        $(this).addClass("table-bordered");
        $(this).addClass("table-striped");
        $(this).addClass("table-condensed");
      });

    });
</script>

</body>
</html>